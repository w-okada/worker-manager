!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var s=r();for(var t in s)("object"==typeof exports?exports:e)[t]=s[t]}}("undefined"!=typeof self?self:this,(()=>(()=>{var e={642:function(e){var r;"undefined"!=typeof self&&self,r=()=>(()=>{"use strict";var e={477:e=>{e.exports=function(e,r,s,t){var o=self||window;try{try{var n;try{n=new o.Blob([e])}catch(r){(n=new(o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder)).append(e),n=n.getBlob()}var i=o.URL||o.webkitURL,a=i.createObjectURL(n),c=new o[r](a,s);return i.revokeObjectURL(a),c}catch(t){return new o[r]("data:application/javascript,".concat(encodeURIComponent(e)),s)}}catch(e){if(!t)throw Error("Inline worker is not supported");return new o[r](t,s)}}}},r={};function s(t){var o=r[t];if(void 0!==o)return o.exports;var n=r[t]={exports:{}};return e[t](n,n.exports,s),n.exports}s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};return(()=>{s.r(t),s.d(t,{BrowserTypes:()=>u,Processor:()=>l,WorkerCommand:()=>e,WorkerManager:()=>c,WorkerResponse:()=>r,getBrowserType:()=>f});const e={INITIALIZE:"initialize",EXECUTE:"execute"},r={INITIALIZED:"initialized",EXECUTED:"EXECUTED"};class o{constructor(){this._resolvers=[],this._promises=[]}_add(){this._promises.push(new Promise((e=>{this._resolvers.push(e)})))}enqueue(e){0==this._resolvers.length&&this._add(),this._resolvers.shift()(e)}dequeue(){return 0==this._promises.length&&this._add(),this._promises.shift()}isEmpty(){return 0==this._promises.length}isBlocked(){return 0!=this._resolvers.length}get length(){return this._promises.length-this._resolvers.length}}var n=s(477),i=s.n(n);const a=e=>{const r=e.transfer.map((r=>{if(r instanceof HTMLCanvasElement){const s=r.transferControlToOffscreen();for(const t in e)e[t]==r&&(e[t]=s);return s}return r}));e.transfer=r};class c{constructor(){this.worker=null,this.processor=null,this.config=null,this.sem=new o,this.lock=async()=>await this.sem.dequeue(),this.unlock=e=>{this.sem.enqueue(e+1)},this.init=async t=>{const o=await this.lock();if(this.config=t,this.worker&&this.worker.terminate(),this.worker=null,"SAFARI"==t.browserType||1==t.onLocal)await(n=t.processorURL,new Promise(((e,r)=>{const s=document.createElement("script");s.src=n,s.async=!0,s.onload=()=>e(window.external_global_component),s.onerror=r,document.body.appendChild(s)}))),this.processor=new s.g[t.processorName](t),console.log("[WorkerManager] Processor work on local");else{const s=i()('(()=>{"use strict";const e="EXECUTED",s=self;let a=null,o=null;onmessage=async t=>{if("initialize"===t.data.message)a=t.data.config,importScripts(a.processorURL),o=new self[a.processorName](a),s.postMessage({message:"initialized"});else if("execute"===t.data.message){if(!a||!o)return i=`${a?.processorName||"Config or Processor"} is not initialized.`,void s.postMessage({message:e,data:["error",i]});const r=t.data.params,n=o.process(r);s.postMessage({message:e,data:n},n.transfer)}else console.log("not implemented");var i}})();',"Worker",void 0,void 0),o=new Promise(((o,n)=>{s.onmessage=e=>{e.data.message===r.INITIALIZED?(this.worker=s,o()):(console.warn("Initialization something wrong.."),n())},a(t),s.postMessage({message:e.INITIALIZE,config:t},t.transfer)}));await o,console.log("[WorkerManager] Processor work on Worker")}var n;await this.unlock(o)},this.execute=async s=>{if(this.sem.length>100)throw new Error(`queue is fulled: ${this.sem.length}`);if(!this.config)throw new Error("no config.");const t=await this.lock();try{if("SAFARI"==this.config.browserType||1==this.config.onLocal){if(!this.processor)throw new Error("processor is not activated.");return this.processor.process(s)}{const t=new Promise(((t,o)=>{this.worker?(this.worker.onmessage=e=>{e.data.message===r.EXECUTED?t(e.data.data):(console.error("Execute is panic: unknwon message",e.data.message),o(e))},a(s),this.worker.postMessage({message:e.EXECUTE,params:s},s.transfer)):o("worker is not activated. 2")}));return await t}}catch(e){throw e}finally{this.unlock(t)}},this.sem.enqueue(0)}}class l{}const u={MSIE:"MSIE",EDGE:"EDGE",CHROME:"CHROME",SAFARI:"SAFARI",FIREFOX:"FIREFOX",OPERA:"OPERA",OTHER:"OTHER"},f=()=>{var e=window.navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")||-1!==e.indexOf("trident")?u.MSIE:-1!==e.indexOf("edge")?u.EDGE:-1!==e.indexOf("chrome")?u.CHROME:-1!==e.indexOf("safari")?u.SAFARI:-1!==e.indexOf("firefox")?u.FIREFOX:-1!==e.indexOf("opera")?u.OPERA:u.OTHER}})(),t})(),e.exports=r()}},r={};function s(t){var o=r[t];if(void 0!==o)return o.exports;var n=r[t]={exports:{}};return e[t].call(n.exports,n,n.exports,s),n.exports}s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};return(()=>{"use strict";s.r(t),s.d(t,{HelloWorldProcessor:()=>r});var e=s(642);class r extends e.Processor{constructor(e){super(),this._errorResult=e=>({status:"fail",transfer:[]}),this.process=e=>{const r=e;switch(r.type){case"morning":console.log(`${"ja"==this.config.langs?"おはよう":"GOOD MORINING!!!"} ${r.name}`);break;case"evening":console.log(`${"ja"==this.config.langs?"こんばんわ":"GOOD EVENING"} ${r.name}`);break;default:return this._errorResult(`UNKNOWN FUNCTION: ${r.type}`)}const s=new Uint8Array(r.transfer[0]);return console.log("DATA:::",s),{status:"success",transfer:[]}},this.config=e}}})(),t})()));